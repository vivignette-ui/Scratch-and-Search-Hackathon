<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Brand Ad Scene Player â€“ Module C</title>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: #111;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
    }

    /* Vertical short-video canvas */
    .scene {
      position: relative;
      width: 360px;
      height: 640px;
      overflow: hidden;
      border-radius: 24px;
      background: radial-gradient(circle at top, #ffe0f0 0%, #ffc0d8 40%, #f58ab0 80%);
      box-shadow: 0 24px 60px rgba(0,0,0,0.45);
    }

    /* Global camera motion */
    .scene-inner {
      position: absolute;
      inset: 0;
      transform-origin: center;
      animation: cameraZoom 9s linear infinite;
    }

    @keyframes cameraZoom {
      0%   { transform: scale(1.0); }
      100% { transform: scale(1.06); }
    }

    /* Base element */
    .el {
      position: absolute;
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
    }

    /* Fallback visuals (when no asset image is provided) */
    .bottle {
      width: 120px;
      height: 320px;
      border-radius: 40px;
      background: linear-gradient(to bottom, #ffbf6d, #b54b16 40%, #5a1c06);
      transform: translate(-50%, -50%);
      box-shadow: 0 18px 40px rgba(0,0,0,0.35);
    }

    .pineapple {
      width: 40px;
      height: 40px;
      border-radius: 12px;
      background: radial-gradient(circle, #ffe699, #ffbf3f 40%, #f28a00);
      box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }

    .ferris-wheel {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: radial-gradient(circle, #ffe9f6, #ffb6d9 60%, #ff8fc8);
    }

    .solo-can {
      width: 40px;
      height: 70px;
      border-radius: 16px;
      background: linear-gradient(to bottom, #ffffff, #ffe3f7 40%, #ffc8ed);
      box-shadow: 0 8px 14px rgba(0,0,0,0.4);
    }

    .tree {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: radial-gradient(circle, #e9ffef, #58c978 40%, #21753c);
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    .person {
      width: 6px;
      height: 12px;
      border-radius: 3px;
      background: #333;
    }

    /* Layout presets */
    .pos-bottle-center { left: 50%; top: 52%; transform: translate(-50%, -50%); }
    .pos-wheel-right   { right: -6%; top: 36%; }
    .pos-solo-can-left { left: 10%; bottom: 14%; }
    .pos-tree-1        { left: 23%; top: 72%; }
    .pos-person-1      { left: 28%; top: 80%; }

    /* Motion presets */
    @keyframes bottleYaw {
      0%   { transform: translate(-50%, -50%) rotateY(-3deg); }
      100% { transform: translate(-50%, -50%) rotateY(3deg); }
    }
    .motion-yaw { animation: bottleYaw 4s ease-in-out infinite alternate; }

    @keyframes pineappleFloat {
      0%   { transform: translateY(0); }
      50%  { transform: translateY(-6px); }
      100% { transform: translateY(0); }
    }
    .motion-float { animation: pineappleFloat 3s ease-in-out infinite; }

    @keyframes wheelRotate {
      0%   { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .motion-rotate-wheel { animation: wheelRotate 20s linear infinite; }

    @keyframes soloRise {
      0%   { transform: translateY(0); }
      50%  { transform: translateY(-80px); }
      100% { transform: translateY(0); }
    }
    @keyframes soloSpin {
      0%   { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .motion-rise-spin {
      animation: soloRise 9s ease-in-out infinite, soloSpin 4s linear infinite;
    }

    @keyframes sway {
      0%   { transform: translateX(0); }
      50%  { transform: translateX(2px); }
      100% { transform: translateX(0); }
    }
    .motion-sway { animation: sway 2.4s ease-in-out infinite; }

  </style>
</head>

<body>
  <div class="scene">
    <div class="scene-inner" id="scene-inner"></div>
  </div>

  <script>
    /* ==========================
       Asset Catalog (Module B output)
       ========================== */

    const assetCatalog = {
      product_main: {
        type: "bottle",
        url: "https://via.placeholder.com/400x800/FFAA88/ffffff?text=PRODUCT"
      },
      fruit_yellow: {
        type: "pineapple",
        url: "https://via.placeholder.com/120/FFD95C/ffffff?text=FRUIT"
      },
      ring_basic: {
        type: "ring",
        url: "https://via.placeholder.com/200/FFC0E0/ffffff?text=RING"
      },
      sphere_basic: {
        type: "sphere",
        url: "https://via.placeholder.com/140/C0FFE0/ffffff?text=SPHERE"
      },
      crystal_basic: {
        type: "crystal",
        url: "https://via.placeholder.com/140/E0C0FF/ffffff?text=CRYSTAL"
      }
    };

    /* ==========================
       adJson (A + B combined output)
       ========================== */

    const adJson = {
      shots: [
        {
          id: 1,
          duration: 9000,
          camera: {
            movement: "slow-zoom-in",
            angle: "slightly-top-down"
          },
          elements: [
            {
              id: "product",
              type: "bottle",
              motion: "yaw",
              presetPosition: "pos-bottle-center",
              assetId: "product_main"
            },
            {
              id: "fruitTop",
              type: "pineapple",
              motion: "float",
              position: { x: 50, y: 26 },
              assetId: "fruit_yellow"
            },
            {
              id: "wheelRight",
              type: "ferris-wheel",
              motion: "rotate-wheel",
              presetPosition: "pos-wheel-right",
              assetId: "ring_basic"
            },
            {
              id: "soloCan",
              type: "solo-can",
              motion: "rise-spin",
              presetPosition: "pos-solo-can-left",
              assetId: "sphere_basic"
            },
            {
              id: "tree1",
              type: "tree",
              presetPosition: "pos-tree-1",
              assetId: "crystal_basic"
            },
            {
              id: "person1",
              type: "person",
              motion: "sway",
              presetPosition: "pos-person-1"
            }
          ]
        }
      ]
    };

    /* ==========================
       Motion mapping
       ========================== */

    function motionToClass(motion) {
      switch (motion) {
        case "yaw": return "motion-yaw";
        case "float": return "motion-float";
        case "rotate-wheel": return "motion-rotate-wheel";
        case "rise-spin": return "motion-rise-spin";
        case "sway": return "motion-sway";
        default: return null;
      }
    }

    /* ==========================
       Renderer (Module C core)
       ========================== */

    function renderShot(shot) {
      const inner = document.getElementById("scene-inner");
      inner.innerHTML = "";
      const refs = {};

      shot.elements.forEach(el => {
        const node = document.createElement("div");
        node.className = "el " + el.type;

        if (el.position) {
          node.style.left = el.position.x + "%";
          node.style.top = el.position.y + "%";
        }
        if (el.presetPosition) {
          node.classList.add(el.presetPosition);
        }

        if (el.assetId && assetCatalog[el.assetId]) {
          node.style.backgroundImage = `url('${assetCatalog[el.assetId].url}')`;
        } else if (el.asset) {
          node.style.backgroundImage = `url('${el.asset}')`;
        }

        const motionClass = motionToClass(el.motion);
        if (motionClass) node.classList.add(motionClass);

        inner.appendChild(node);
        refs[el.id] = node;
      });
    }

    renderShot(adJson.shots[0]);
  </script>
</body>
</html>
